

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>oasislmf.model_execution.bin &mdash; Oasis LMF 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Oasis LMF
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/piwind_model.html">PiWind - toy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/running_a_model_using_the_MDK.html">Run a model using the Oasis MDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/running_a_model_using_the_Oasis_API.html">Run a model using the Oasis API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/running_a_model_using_the_Oasis_UI.html">Run a model using the Oasis UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/FAQ.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide/platform_architecture.html">Platform architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide/development_approach.html">Development approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide/github_repositories.html">GitHub repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide/technology_stack.html">Technology stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide/release_process.html">Release process</a></li>
</ul>
<p class="caption"><span class="caption-text">Modelling methodology</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelling_methodology/what_is_a_catastrophe_model.html">What is a catastrophe model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelling_methodology/simulation_methodology.html">Simulation methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelling_methodology/financial_modelling_and_exposure_data.html">Financial modelling and exposure data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modelling_methodology/risk_metrics.html">Risk metrics</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/oasis_rest_api.html">Oasis API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/oasis_mdk.html">Model Development Kit (MDK)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/modules.html">Module documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/latest_release.html">Latest release</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Oasis LMF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">oasislmf.model_execution.bin</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/autoapi/oasislmf/model_execution/bin/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-oasislmf.model_execution.bin">
<span id="oasislmf-model-execution-bin"></span><h1><a class="reference internal" href="#module-oasislmf.model_execution.bin" title="oasislmf.model_execution.bin"><code class="xref py py-mod docutils literal notranslate"><span class="pre">oasislmf.model_execution.bin</span></code></a><a class="headerlink" href="#module-oasislmf.model_execution.bin" title="Permalink to this headline">¶</a></h1>
<p><p>Python utilities used for setting up the structure of the run directory
in which to prepare the inputs to run a model or generate deterministic
losses, and store the outputs.</p>
</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="oasislmf.model_execution.bin.prepare_run_directory">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">prepare_run_directory</code><span class="sig-paren">(</span><em class="sig-param">run_dir</em>, <em class="sig-param">oasis_src_fp</em>, <em class="sig-param">model_data_fp</em>, <em class="sig-param">analysis_settings_fp</em>, <em class="sig-param">inputs_archive=None</em>, <em class="sig-param">user_data_dir=None</em>, <em class="sig-param">ri=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#prepare_run_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.prepare_run_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that the model run directory has the correct folder structure in
order for the model run script (ktools) to be executed. Without the RI
flag the model run directory will have the following structure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;run_directory&gt;
|-- fifo/
|-- input/
|   `-- csv/
|-- output/
|-- static/
|-- work/
|-- analysis_settings.json
`-- run_ktools.sh
</pre></div>
</div>
<p>where the direct GUL and/or FM input files exist in the <code class="docutils literal notranslate"><span class="pre">input/csv</span></code>
subfolder and the corresponding binaries exist in the <code class="docutils literal notranslate"><span class="pre">input</span></code> subfolder.</p>
<p>With the RI flag the model run directory has the following structure</p>
<dl class="simple">
<dt>::</dt><dd><p>&lt;run_directory&gt;
<a href="#id1"><span class="problematic" id="id2">|</span></a>– fifo
<a href="#id3"><span class="problematic" id="id4">|</span></a>– input
<a href="#id5"><span class="problematic" id="id6">|</span></a>– RI_1
<a href="#id7"><span class="problematic" id="id8">|</span></a>– RI_2
<a href="#id9"><span class="problematic" id="id10">|</span></a>– …
<a href="#id11"><span class="problematic" id="id12">|</span></a>– output
<a href="#id13"><span class="problematic" id="id14">|</span></a>– static
<a href="#id15"><span class="problematic" id="id16">|</span></a>– work
<a href="#id17"><span class="problematic" id="id18">|</span></a>– ri_layers.json
<a href="#id19"><span class="problematic" id="id20">|</span></a>– analysis_settings.json
<a href="#id21"><span class="problematic" id="id22">`</span></a>– run_ktools.sh</p>
</dd>
</dl>
<p>where the direct GUL and/or FM input files, and the corresponding binaries
exist in the <code class="docutils literal notranslate"><span class="pre">input</span></code> subfolder, and the RI layer input files and binaries
exist in the <code class="docutils literal notranslate"><span class="pre">RI</span></code> prefixed subfolders.</p>
<p>If any subfolders are missing they are created.</p>
<p>Optionally, if the path to a set of Oasis files is provided then they
are copied into the <code class="docutils literal notranslate"><span class="pre">input/csv</span></code> subfolder.</p>
<p>Optionally, if the path to the analysis settings JSON file is provided
then it is copied to the base of the run directory.</p>
<p>Optionally, if the path to model data is provided then the files are
symlinked into the <code class="docutils literal notranslate"><span class="pre">static</span></code> subfolder provided the OS is of type
Darwin or Linux, otherwise the source folder tree is recursively
copied into the <code class="docutils literal notranslate"><span class="pre">static</span></code> subfolder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the model run directory</p></li>
<li><p><strong>oasis_src_fp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – path to a set of Oasis files</p></li>
<li><p><strong>ri</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Boolean flag for RI mode</p></li>
<li><p><strong>analysis_settings_fp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – analysis settings JSON file path</p></li>
<li><p><strong>model_data_fp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – model data source path</p></li>
<li><p><strong>inputs_archive</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – path to a tar file containing input files</p></li>
</ul>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>user_data_dir: path to a directory containing additional user-supplied model data</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.prepare_run_inputs">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">prepare_run_inputs</code><span class="sig-paren">(</span><em class="sig-param">analysis_settings</em>, <em class="sig-param">run_dir</em>, <em class="sig-param">ri=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#prepare_run_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.prepare_run_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up binary files in the model inputs directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_settings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – model analysis settings dict</p></li>
<li><p><strong>run_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – model run directory</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.check_inputs_directory">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">check_inputs_directory</code><span class="sig-paren">(</span><em class="sig-param">directory_to_check</em>, <em class="sig-param">il=False</em>, <em class="sig-param">ri=False</em>, <em class="sig-param">check_binaries=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#check_inputs_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.check_inputs_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that all the required files are present in the directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory_to_check</strong> (<em>string</em>) – directory containing the CSV files</p></li>
<li><p><strong>il</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – check insuured loss files</p></li>
<li><p><strong>il</strong> – check resinsurance sub-folders</p></li>
<li><p><strong>check_binaries</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – check binary files are not present</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.csv_to_bin">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">csv_to_bin</code><span class="sig-paren">(</span><em class="sig-param">csv_directory</em>, <em class="sig-param">bin_directory</em>, <em class="sig-param">il=False</em>, <em class="sig-param">ri=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#csv_to_bin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.csv_to_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the binary files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_directory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the directory containing the CSV files</p></li>
<li><p><strong>bin_directory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the directory to write the binary files</p></li>
<li><p><strong>il</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to create the binaries required for insured loss calculations</p></li>
<li><p><strong>ri</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to create the binaries required for reinsurance calculations</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="../../utils/exceptions/index.html#oasislmf.utils.exceptions.OasisException" title="oasislmf.utils.exceptions.OasisException"><strong>OasisException</strong></a> – If one of the conversions fails</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.check_binary_tar_file">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">check_binary_tar_file</code><span class="sig-paren">(</span><em class="sig-param">tar_file_path</em>, <em class="sig-param">check_il=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#check_binary_tar_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.check_binary_tar_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that all required files are present</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tar_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Path to the tar file to check</p></li>
<li><p><strong>check_il</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag whether to check insured loss files</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="../../utils/exceptions/index.html#oasislmf.utils.exceptions.OasisException" title="oasislmf.utils.exceptions.OasisException"><strong>OasisException</strong></a> – If a required file is missing</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if all required files are present, False otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.create_binary_tar_file">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">create_binary_tar_file</code><span class="sig-paren">(</span><em class="sig-param">directory</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#create_binary_tar_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.create_binary_tar_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Package the binaries in a gzipped tar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directory</strong> – Path containing the binaries</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.check_conversion_tools">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">check_conversion_tools</code><span class="sig-paren">(</span><em class="sig-param">il=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#check_conversion_tools"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.check_conversion_tools" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the conversion tools are available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>il</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag whether to check insured loss tools</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all required tools are present, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="oasislmf.model_execution.bin.cleanup_bin_directory">
<code class="sig-prename descclassname">oasislmf.model_execution.bin.</code><code class="sig-name descname">cleanup_bin_directory</code><span class="sig-paren">(</span><em class="sig-param">directory</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/oasislmf/model_execution/bin.html#cleanup_bin_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#oasislmf.model_execution.bin.cleanup_bin_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the tar and binary files.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Oasis LMF

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>