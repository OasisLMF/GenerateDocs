:mod:`oasislmf.model_preparation.il_inputs`
===========================================

.. py:module:: oasislmf.model_preparation.il_inputs


Module Contents
---------------

.. function:: get_grouped_fm_profile_by_level_and_term_group(exposure_profile=get_default_exposure_profile(), accounts_profile=get_default_accounts_profile(), grouped_profile_by_level=None)


.. function:: get_grouped_fm_terms_by_level_and_term_group(exposure_profile=get_default_exposure_profile(), accounts_profile=get_default_accounts_profile(), grouped_profile_by_level=None, grouped_profile_by_level_and_term_group=None, lowercase=True)


.. function:: get_calc_rule_ids(il_inputs_df)

   Returns a Numpy array of calc. rule IDs from a table of IL input items

   :param il_inputs_df: IL input items dataframe
   :type il_inputs_df: pandas.DataFrame

   :return: Numpy array of calc. rule IDs
   :rtype: numpy.ndarray


.. function:: get_policytc_ids(il_inputs_df)

   Returns a Numpy array of policy TC IDs from a table of IL input items

   :param il_inputs_df: IL input items dataframe
   :type il_inputs_df: pandas.DataFrame

   :return: Numpy array of policy TC IDs
   :rtype: numpy.ndarray


.. function:: get_il_input_items(exposure_df, gul_inputs_df, accounts_df=None, accounts_fp=None, exposure_profile=get_default_exposure_profile(), accounts_profile=get_default_accounts_profile(), fm_aggregation_profile=get_default_fm_aggregation_profile())

   Generates and returns a Pandas dataframe of IL input items.

   :param exposure_df: Source exposure
   :type exposure_df: pandas.DataFrame

   :param gul_inputs_df: GUL input items
   :type gul_inputs_df: pandas.DataFrame

   :param accounts_df: Source accounts dataframe (optional)
   :param accounts_df: pandas.DataFrame

   :param accounts_fp: Source accounts file path (optional)
   :param accounts_fp: str

   :param exposure_profile: Source exposure profile (optional)
   :type exposure_profile: dict

   :param accounts_profile: Source accounts profile (optional)
   :type accounts_profile: dict

   :param fm_aggregation_profile: FM aggregation profile (optional)
   :param fm_aggregation_profile: dict

   :return: IL inputs dataframe
   :rtype: pandas.DataFrame

   :return Accounts dataframe
   :rtype: pandas.DataFrame


.. function:: write_fm_policytc_file(il_inputs_df, fm_policytc_fp, chunksize=100000)

   Writes an FM policy T & C file.

   :param il_inputs_df: IL inputs dataframe
   :type il_inputs_df: pandas.DataFrame

   :param fm_policytc_fp: FM policy TC file path
   :type fm_policytc_fp: str

   :return: FM policy TC file path
   :rtype: str


.. function:: write_fm_profile_file(il_inputs_df, fm_profile_fp, chunksize=100000)

   Writes an FM profile file.

   :param il_inputs_df: IL inputs dataframe
   :type il_inputs_df: pandas.DataFrame

   :param fm_profile_fp: FM profile file path
   :type fm_profile_fp: str

   :return: FM profile file path
   :rtype: str


.. function:: write_fm_programme_file(il_inputs_df, fm_programme_fp, chunksize=100000)

   Writes an FM programme file.

   :param il_inputs_df: IL inputs dataframe
   :type il_inputs_df: pandas.DataFrame

   :param fm_programme_fp: FM programme file path
   :type fm_programme_fp: str

   :return: FM programme file path
   :rtype: str


.. function:: write_fm_xref_file(il_inputs_df, fm_xref_fp, chunksize=100000)

   Writes an FM xref file.

   :param il_inputs_df: IL inputs dataframe
   :type il_inputs_df: pandas.DataFrame

   :param fm_xref_fp: FM xref file path
   :type fm_xref_fp: str

   :return: FM xref file path
   :rtype: str


.. function:: write_il_input_files(il_inputs_df, target_dir, oasis_files_prefixes=copy.deepcopy(OASIS_FILES_PREFIXES['il']), chunksize=2 * 10**5)

   Writes standard Oasis IL input files to a target directory using a
   pre-generated dataframe of IL inputs dataframe. The files written are
   ::

       fm_policytc.csv
       fm_profile.csv
       fm_programme.csv
       fm_xref.csv

   :param il_inputs_df: IL inputs dataframe
   :type exposure_df: pandas.DataFrame

   :param target_dir: Target directory in which to write the files
   :type target_dir: str

   :param oasis_files_prefixes: Oasis IL input file name prefixes
   :param oasis_files_prefixes: dict

   :param chunksize: The chunk size to use when writing out the
                     input files
   :type chunksize: int

   :return: IL input files dict
   :rtype: dict


