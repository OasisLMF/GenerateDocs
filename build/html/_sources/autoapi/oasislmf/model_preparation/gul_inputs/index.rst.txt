:mod:`oasislmf.model_preparation.gul_inputs`
============================================

.. py:module:: oasislmf.model_preparation.gul_inputs


Module Contents
---------------

.. function:: get_gul_input_items(exposure_fp, keys_fp, exposure_profile=get_default_exposure_profile(), group_id_cols=['loc_id'])

   Generates and returns a Pandas dataframe of GUL input items.

   :param exposure_fp: Exposure file
   :type exposure_fp: str

   :param keys_fp: Keys file path
   :type keys_fp: str

   :param exposure_profile: Exposure profile
   :type exposure_profile: dict

   :return: GUL inputs dataframe
   :rtype: pandas.DataFrame

   :return: Exposure dataframe
   :rtype: pandas.DataFrame


.. function:: write_complex_items_file(gul_inputs_df, complex_items_fp, chunksize=100000)

   Writes a complex model items file.

   :param gul_inputs_df: GUL inputs dataframe
   :type gul_inputs_df: pandas.DataFrame

   :param complex_items_fp: Complex/custom model items file path
   :type complex_items_fp: str

   :return: Complex/custom model items file path
   :rtype: str


.. function:: write_items_file(gul_inputs_df, items_fp, chunksize=100000)

   Writes an items file.

   :param gul_inputs_df: GUL inputs dataframe
   :type gul_inputs_df: pandas.DataFrame

   :param items_fp: Items file path
   :type items_fp: str

   :return: Items file path
   :rtype: str


.. function:: write_coverages_file(gul_inputs_df, coverages_fp, chunksize=100000)

   Writes a coverages file.

   :param gul_inputs_df: GUL inputs dataframe
   :type gul_inputs_df: pandas.DataFrame

   :param coverages_fp: Coverages file path
   :type coverages_fp: str

   :return: Coverages file path
   :rtype: str


.. function:: write_gul_input_files(gul_inputs_df, target_dir, oasis_files_prefixes=copy.deepcopy(OASIS_FILES_PREFIXES['gul']), chunksize=2 * 10**5)

   Writes the standard Oasis GUL input files to a target directory, using a
   pre-generated dataframe of GUL input items. The files written are
   ::

       items.csv
       coverages.csv

   and optionally a complex items file in case of a complex/custom model.

   :param gul_inputs_df: GUL inputs dataframe
   :type gul_inputs_df: pandas.DataFrame

   :param target_dir: Target directory in which to write the files
   :type target_dir: str

   :param oasis_files_prefixes: Oasis GUL input file name prefixes
   :param oasis_files_prefixes: dict

   :param chunksize: The chunk size to use when writing out the
                     input files
   :type chunksize: int

   :return: GUL input files dict
   :rtype: dict


